* 如果发现需要为程序添加一个特性，而代码结构使你无法很方便的达成目的，那就先重构那个程序，使特性的添加比较容易进行，然后再添加特性

* 重构

  ~~~
  为即将修改的代码构建可靠的测试环境
  
  拆分复杂的方法
  
  见名知义的命名
  
  将方法或变量放在合适的类中
  
  合理使用设计模式，提升扩展性
  ~~~

* 重构手法

* 重新组织函数

  * 提炼函数
  
  * 内联函数
  
    ~~~java
    int getRating(){
        return (moreThanFiveLateDeliveries()) ? 2 : 1;
    }
    
    boolean moreThanFiveLateDeliveries(){
        return numberOfLateDeliveries > 5;
    }
    ~~~
    V
    
    V
    
    ~~~java
    int getRating(){
        return (numberOfLateDeliveries > 5) ? 2 : 1;
    }
    ~~~
    
  * 内联临时变量
  
  * 以查询代替临时变量
  
  * 引入解释型变量
  
  * 分解临时变量
  
  * 移除对参数的赋值
  
  * 以函数对象取代函数
  
    将一个过大的函数放进一个单独的对象中，这样这个函数中的局部变量就可以变为对象内的字段，然后就可以在同一个对象中将这个大函数分解
  
  * 替换算法
  
    寻找实现算法的最简，最清晰的程序

* 在对象之间搬移特性

  * 搬移函数

    在一个类中，有个函数与其所驻类之外的另一个类有很多相互调用时，可以在该类中建立一个类似行为的函数，将旧函数变成一个委托函数，或者直接移除
    
  * 搬移字段
  
  * 提炼类
  
  * 将类内联化
  
  * 隐藏委托关系
  
  * 引入外加函数
  
  * 引入本地扩展（子类化，包装类）
  
* 重新组织数据

  * 自封装字段（getter and setter）
  * 以对象取代数据值
  * 将值对象改为引用对象（可以视情况而定）
  * 以对象取代数组
  * 复制“被监视对象”
  * 将单项关联改为双向关联
  * 以字面常量取代魔法数
  * 封装集合（get, set,add,remove）
  * 以子类取代类型码
  * 以策略模式/状态模式取代类型码
  * 以字段取代子类
  
* 简化条件表达式

  * 分解表达式

  * 合并表达式

  * 合并重复的条件片段

  * 移除控制标记

    以 break 或 return 取代控制标记

  * 以卫语句取代嵌套条件表达式

  * 以多态取代条件表达式

* 简化函数调用

  * 函数名见名知意
  
  * 增加参数
  
  * 移除参数
  
  * 将查询函数和修改函数分离
  
  * 令函数携带参数
  
  * 以明确函数取代参数
  
  * 保证对象完整
  
  * 以函数取代参数
  
  * 引入参数对象
  
    某些参数总是在同时出现
  
  * 移除设值函数
  
  * 隐藏函数
  
  * 以工厂函数取代构造函数
  
  * 封装向下转型
  
    某个函数返回的对象，需要由函数调用者执行向下转型，将向下转型动作移到函数中
  
    ~~~ java
    Object lastReading(){
        return readings.lastElement();
    }
    
    
    //  ||
    // VVVV
    
    
    Reading lastReading(){
        return (Reading)readings.lastElement();
    }
    ~~~
  
  * 以异常取代错误码
  
  * 以测试取代异常
  
* 处理概括关系

  * 字段上移
  * 函数上移
  * 构造函数上移
  * 函数下移
  * 字段下移
  * 提炼子类
  * 提炼超类

